
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/modules/streamingmodule/">
      
      
        <link rel="prev" href="../../models/resnet/">
      
      
        <link rel="next" href="../basemodule/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>streamingmodule - Lightstream</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#streamingmodule" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Lightstream" class="md-header__button md-logo" aria-label="Lightstream" data-md-component="logo">
      
  <img src="../../images/lightning_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lightstream
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              streamingmodule
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/DIAGNijmegen/lightstream" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    diagnijmegen/lightstream
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Lightstream" class="md-nav__button md-logo" aria-label="Lightstream" data-md-component="logo">
      
  <img src="../../images/lightning_icon.png" alt="logo">

    </a>
    Lightstream
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DIAGNijmegen/lightstream" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    diagnijmegen/lightstream
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/custom_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/dataloading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/trainer_options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trainer options
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/resnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ResNet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    streamingmodule
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    streamingmodule
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule" class="md-nav__link">
    StreamingModule
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.backward_streaming" class="md-nav__link">
    backward_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.configure_tile_delta" class="md-nav__link">
    configure_tile_delta()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.disable_streaming" class="md-nav__link">
    disable_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.enable_streaming" class="md-nav__link">
    enable_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.forward_streaming" class="md-nav__link">
    forward_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.freeze_streaming_normalization_layers" class="md-nav__link">
    freeze_streaming_normalization_layers()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.get_trainable_params" class="md-nav__link">
    get_trainable_params()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.on_train_epoch_start" class="md-nav__link">
    on_train_epoch_start()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.on_train_start" class="md-nav__link">
    on_train_start()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.on_validation_start" class="md-nav__link">
    on_validation_start()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../basemodule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basemodule
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule" class="md-nav__link">
    StreamingModule
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.backward_streaming" class="md-nav__link">
    backward_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.configure_tile_delta" class="md-nav__link">
    configure_tile_delta()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.disable_streaming" class="md-nav__link">
    disable_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.enable_streaming" class="md-nav__link">
    enable_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.forward_streaming" class="md-nav__link">
    forward_streaming()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.freeze_streaming_normalization_layers" class="md-nav__link">
    freeze_streaming_normalization_layers()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.get_trainable_params" class="md-nav__link">
    get_trainable_params()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.on_train_epoch_start" class="md-nav__link">
    on_train_epoch_start()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.on_train_start" class="md-nav__link">
    on_train_start()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules.streaming.StreamingModule.on_validation_start" class="md-nav__link">
    on_validation_start()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="streamingmodule">StreamingModule</h1>


<div class="doc doc-object doc-class">



<a id="modules.streaming.StreamingModule"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="lightning.LightningModule">LightningModule</span></code></p>


            <details class="quote">
              <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StreamingModule</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">LightningModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream_network</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="n">use_streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train_streaming_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="o">=</span> <span class="n">use_streaming</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_streaming_layers</span> <span class="o">=</span> <span class="n">train_streaming_layers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream_module</span> <span class="o">=</span> <span class="n">stream_network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_trainable_params</span><span class="p">()</span>

        <span class="c1"># StreamingCNN options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tile_size</span> <span class="o">=</span> <span class="n">tile_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"deterministic"</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saliency</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"saliency"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy_to_gpu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"copy_to_gpu"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"verbose"</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"mean"</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"std"</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statistics_on_cpu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"statistics_on_cpu"</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_on_gpu</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"normalize_on_gpu"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">statistics_on_cpu</span><span class="p">:</span>
            <span class="c1"># Move to cuda manually if statistics are computed on gpu</span>
            <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
            <span class="n">stream_network</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span> <span class="o">=</span> <span class="n">StreamingCNN</span><span class="p">(</span>
            <span class="n">stream_network</span><span class="p">,</span>
            <span class="n">tile_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">),</span>
            <span class="n">deterministic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span><span class="p">,</span>
            <span class="n">saliency</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">saliency</span><span class="p">,</span>
            <span class="n">copy_to_gpu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy_to_gpu</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">statistics_on_cpu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_on_cpu</span><span class="p">,</span>
            <span class="n">normalize_on_gpu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_on_gpu</span><span class="p">,</span>
            <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
            <span class="n">std</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span>
            <span class="n">state_dict</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"state_dict"</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disable_streaming</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">freeze_streaming_normalization_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Do not use normalization layers within lightstream, only local ops are allowed"""</span>
        <span class="n">freeze_layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">stream_module</span><span class="o">.</span><span class="n">modules</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">freeze_layers</span><span class="p">:</span>
            <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_train_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">""" on_train_epoch_start hook</span>

<span class="sd">        Do not override this method. Instead, call the parent class using super().on_train_start if you want</span>
<span class="sd">        to add this hook into your pipelines</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freeze_streaming_normalization_layers</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_validation_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">""" on_validation_start hook</span>

<span class="sd">        Do not override this method. Instead, call the parent class using super().on_train_start if you want</span>
<span class="sd">        to add this hook into your pipelines</span>

<span class="sd">        """</span>
        <span class="c1"># Update streaming to put all the inputs/tensors on the right device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span> <span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">""" on_train_start hook</span>

<span class="sd">        Do not override this method. Instead, call the parent class using super().on_train_start if you want</span>
<span class="sd">        to add this hook into your pipelines</span>

<span class="sd">        """</span>
        <span class="c1"># Update streaming to put all the inputs/tensors on the right device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span> <span class="nf">disable_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Disable streaming hooks and replace streamingconv2d  with conv2d modules</span>

<span class="sd">        This will still use the StreamingCNN backward and forward functions, but the memory gains from gradient</span>
<span class="sd">        checkpointing will be turned off.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">enable_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Enable streaming hooks and use streamingconv2d modules"""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">forward_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : torch.Tensor</span>
<span class="sd">        The input tensor in [1,C,H,W] format</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out: torch.Tensor</span>
<span class="sd">        The output of the streaming model</span>

<span class="sd">        """</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">stream_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">backward_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">gradient</span><span class="p">):</span>
<span class="w">        </span><span class="sd">""" Perform the backward pass using the streaming network</span>

<span class="sd">        Backward only if streaming is turned on.</span>
<span class="sd">        This method is primarily a convenience function</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        image: torch.Tensor</span>
<span class="sd">            The input image in [1,C,H,W] format</span>
<span class="sd">        gradient: torch.Tensor</span>
<span class="sd">            The gradient of the next layer in the model to continue backpropagation with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        """</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_streaming_layers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">gradient</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">configure_tile_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Helper function that returns the tile stride during streaming.</span>

<span class="sd">        Streaming assumes that the input image is perfectly divisible with the network output stride or the</span>
<span class="sd">        tile stride. This function will return the tile stride, which can then be used within data processing pipelines</span>
<span class="sd">        to pad/crop images to a multiple of the tile stride.</span>

<span class="sd">        Examples:</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tile_delta: numpy.ndarray</span>
<span class="sd">            the tile stride.</span>


<span class="sd">        """</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_size</span> <span class="o">-</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">tile_gradient_lost</span><span class="o">.</span><span class="n">left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">tile_gradient_lost</span><span class="o">.</span><span class="n">right</span>
        <span class="p">)</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">output_stride</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">delta</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">output_stride</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">delta</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_trainable_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">""" Get trainable parameters for the entire model</span>

<span class="sd">        If self.streaming_layers is True, then the parameters of the streaming network will be trained.</span>
<span class="sd">        Otherwise, the parameters will be left untrained (no gradients will be collected)</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_streaming_layers</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stream_module</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">params</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"WARNING: Streaming network will not be trained"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream_module</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
                <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_remove_streaming_network</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Converts the streaming network into a non-streaming network</span>

<span class="sd">        The former streaming encoder can be addressed as self.stream_network</span>
<span class="sd">        This function is currently untested and breaks the class, since there is no way to rebuild the streaming network</span>
<span class="sd">        other than calling a new class directly.</span>

<span class="sd">        """</span>

        <span class="c1"># Convert streamingConv2D into regular Conv2D and turn off streaming hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disable_streaming</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">stream_module</span>

        <span class="c1"># torch modules cannot be overridden normally, so delete and reassign</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="k">def</span> <span class="nf">_build_streaming_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            (re)-build the streaming network</span>
<span class="sd">        """</span>

        <span class="n">stream_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span> <span class="o">=</span> <span class="n">StreamingCNN</span><span class="p">(</span>
            <span class="n">stream_network</span><span class="p">,</span>
            <span class="n">tile_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_size</span><span class="p">),</span>
            <span class="n">deterministic</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"deterministic"</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="n">saliency</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"saliency"</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">gather_gradients</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"gather_gradients"</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">copy_to_gpu</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"copy_to_gpu"</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"verbose"</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="n">statistics_on_cpu</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"statistics_on_cpu"</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">normalize_on_gpu</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"normalize_on_gpu"</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
            <span class="n">std</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span>
            <span class="n">state_dict</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"state_dict"</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.backward_streaming" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">backward_streaming</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">gradient</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Perform the backward pass using the streaming network</p>
<p>Backward only if streaming is turned on.
This method is primarily a convenience function</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>image</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input image in [1,C,H,W] format</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gradient</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The gradient of the next layer in the model to continue backpropagation with</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">backward_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">gradient</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" Perform the backward pass using the streaming network</span>

<span class="sd">    Backward only if streaming is turned on.</span>
<span class="sd">    This method is primarily a convenience function</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image: torch.Tensor</span>
<span class="sd">        The input image in [1,C,H,W] format</span>
<span class="sd">    gradient: torch.Tensor</span>
<span class="sd">        The gradient of the next layer in the model to continue backpropagation with</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    """</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_streaming_layers</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">gradient</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.configure_tile_delta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">configure_tile_delta</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Helper function that returns the tile stride during streaming.</p>
<p>Streaming assumes that the input image is perfectly divisible with the network output stride or the
tile stride. This function will return the tile stride, which can then be used within data processing pipelines
to pad/crop images to a multiple of the tile stride.</p>
<p>Examples:</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tile_delta</code></td>          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the tile stride.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">configure_tile_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Helper function that returns the tile stride during streaming.</span>

<span class="sd">    Streaming assumes that the input image is perfectly divisible with the network output stride or the</span>
<span class="sd">    tile stride. This function will return the tile stride, which can then be used within data processing pipelines</span>
<span class="sd">    to pad/crop images to a multiple of the tile stride.</span>

<span class="sd">    Examples:</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tile_delta: numpy.ndarray</span>
<span class="sd">        the tile stride.</span>


<span class="sd">    """</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tile_size</span> <span class="o">-</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">tile_gradient_lost</span><span class="o">.</span><span class="n">left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">tile_gradient_lost</span><span class="o">.</span><span class="n">right</span>
    <span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">output_stride</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">delta</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">output_stride</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">delta</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.disable_streaming" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">disable_streaming</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Disable streaming hooks and replace streamingconv2d  with conv2d modules</p>
<p>This will still use the StreamingCNN backward and forward functions, but the memory gains from gradient
checkpointing will be turned off.</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">disable_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Disable streaming hooks and replace streamingconv2d  with conv2d modules</span>

<span class="sd">    This will still use the StreamingCNN backward and forward functions, but the memory gains from gradient</span>
<span class="sd">    checkpointing will be turned off.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.enable_streaming" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">enable_streaming</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Enable streaming hooks and use streamingconv2d modules</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">enable_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Enable streaming hooks and use streamingconv2d modules"""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.forward_streaming" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward_streaming</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>The</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>out</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code>The output of the streaming model</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward_streaming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : torch.Tensor</span>
<span class="sd">    The input tensor in [1,C,H,W] format</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out: torch.Tensor</span>
<span class="sd">    The output of the streaming model</span>

<span class="sd">    """</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_streaming</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">stream_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.freeze_streaming_normalization_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">freeze_streaming_normalization_layers</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Do not use normalization layers within lightstream, only local ops are allowed</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">freeze_streaming_normalization_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Do not use normalization layers within lightstream, only local ops are allowed"""</span>
    <span class="n">freeze_layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">stream_module</span><span class="o">.</span><span class="n">modules</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">freeze_layers</span><span class="p">:</span>
        <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.get_trainable_params" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_trainable_params</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get trainable parameters for the entire model</p>
<p>If self.streaming_layers is True, then the parameters of the streaming network will be trained.
Otherwise, the parameters will be left untrained (no gradients will be collected)</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_trainable_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" Get trainable parameters for the entire model</span>

<span class="sd">    If self.streaming_layers is True, then the parameters of the streaming network will be trained.</span>
<span class="sd">    Otherwise, the parameters will be left untrained (no gradients will be collected)</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_streaming_layers</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stream_module</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">params</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"WARNING: Streaming network will not be trained"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream_module</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
            <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.on_train_epoch_start" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_train_epoch_start</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>on_train_epoch_start hook</p>
<p>Do not override this method. Instead, call the parent class using super().on_train_start if you want
to add this hook into your pipelines</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_train_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">""" on_train_epoch_start hook</span>

<span class="sd">    Do not override this method. Instead, call the parent class using super().on_train_start if you want</span>
<span class="sd">    to add this hook into your pipelines</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freeze_streaming_normalization_layers</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.on_train_start" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_train_start</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>on_train_start hook</p>
<p>Do not override this method. Instead, call the parent class using super().on_train_start if you want
to add this hook into your pipelines</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" on_train_start hook</span>

<span class="sd">    Do not override this method. Instead, call the parent class using super().on_train_start if you want</span>
<span class="sd">    to add this hook into your pipelines</span>

<span class="sd">    """</span>
    <span class="c1"># Update streaming to put all the inputs/tensors on the right device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="modules.streaming.StreamingModule.on_validation_start" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_validation_start</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>on_validation_start hook</p>
<p>Do not override this method. Instead, call the parent class using super().on_train_start if you want
to add this hook into your pipelines</p>

          <details class="quote">
            <summary>Source code in <code>lightstream\modules\streaming.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_validation_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" on_validation_start hook</span>

<span class="sd">    Do not override this method. Instead, call the parent class using super().on_train_start if you want</span>
<span class="sd">    to add this hook into your pipelines</span>

<span class="sd">    """</span>
    <span class="c1"># Update streaming to put all the inputs/tensors on the right device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stream_network</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tooltips", "header.autohide", "navigation.instant", "navigation.instant.prefetch", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>